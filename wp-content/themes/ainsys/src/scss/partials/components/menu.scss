/* stylelint-disable no-descending-specificity */
.header {
	&__menu {
		display: flex;
		justify-content: flex-end;
		align-items: center;
		flex: 0 1 100%;
		width: 100%;
		@include media-breakpoint-up( $bp-menu ) {
			justify-content: space-between;
			height: 100%;
		}
	}

	&__toggler {
		width: rem( 5 );
		height: rem( 5 );
		padding: rem( 1 );
		cursor: pointer;

		@include media-breakpoint-up( $bp-menu ) {
			display: none;
		}
		@include media-breakpoint-down( md ) {
			margin-left: auto;
			margin-right: rem( 1 );
		}

		.bar {
			display: block;
			height: rem( 0.3 );
			width: 100%;
			margin: rem( 0.7 ) 0;
			background: $white;
			transition: all 0.3s ease-out 0.2s;
			transform-origin: center;
			// enabling hardware acceleration to animation rendering.
			transform: translateZ( 0 );
			backface-visibility: hidden;
			perspective: 1000;

			&:first-of-type {
				margin-top: rem( 0.35 );
			}
			&:last-of-type {
				margin-bottom: rem( 0.35 );
			}
		}

		&[aria-expanded='true'] {
			.bar {
				&:nth-of-type( 1 ) {
					transform: translate( 0, #{rem( 1 )} ) rotate( -45deg );
				}
				&:nth-of-type( 2 ) {
					opacity: 0;
				}
				&:nth-of-type( 3 ) {
					transform: translate( 0, #{rem( -1 )} ) rotate( 45deg );
				}
			}
		}
	}

	&__menu {
		position: absolute;
		z-index: 2000;
		top: 100%;
		right: 0;
		list-style: none;
		display: block;
		width: rem( 40 );
		max-width: 100%;
		margin: 0;
		padding: rem( 1.6 ) rem( 2 );
		background: $white;
		border-radius: 0 0 0 rem( 2 );
		@include small-shadow();
		transform: translateX( 150% );
		transition: all 0.3s ease-out;

		.menu-open & {
			transform: translateX( 0 );
		}

		@include media-breakpoint-up( $bp-menu ) {
			position: static;
			width: auto;
			max-width: none;
			height: 100%;
			padding: 0;
			background: transparent;
			border-radius: 0;
			box-shadow: none;
			transform: none;
		}
	}
}

.menu {
	display: block;
	overflow-x: hidden;
	overflow-y: auto;
	height: calc( 100vh - #{$header-height} - 2 * #{rem( 1.6 )} );
	padding: rem( 1 ) rem( 1.2 );
	@include styled-scrollbar;

	.announcement-bar-on & {
		height: calc( 100vh - #{$header-height} - #{$announcement-bar-height} - 2 * #{rem( 1.6 )} );
	}

	@include media-breakpoint-up( $bp-menu ) {
		display: flex;
		align-items: stretch;
		justify-content: center;
		overflow: visible;
		height: 100% !important;
		padding: 0;
	}

	li {
		display: flex;
		flex-wrap: wrap;
		margin: 0;
		padding: rem( 1 ) 0;

		@include media-breakpoint-up( $bp-menu ) {
			flex-wrap: nowrap;
			position: relative;
			padding: 0 rem( 3 ) 0 0;
		}

		a {
			font-size: rem( 1.6 );
			font-weight: 400;
			color: $dark;
			transition: all 0.3s ease-out;

			&:hover,
			&:focus,
			&:active {
				@include a-hover;
				color: $accent;
			}
			@include media-breakpoint-up( $bp-menu ) {
				display: flex;
				align-items: center;
				height: 100%;
				padding-top: 1px;
				border-bottom: 1px solid transparent;
				color: $white;

				&:hover,
				&:focus,
				&:active {
					color: $accent;
				}
			}

			&.menu__submenu-toggler {
				align-self: center;
				width: 22px;
				height: 22px;
				padding: 0;
				border: 0;
				//background: url( ../images/components/chevron-down.svg ) no-repeat right center;

				@include media-breakpoint-up( $bp-menu ) {
					background: url( ../images/components/chevron-down-white.svg ) no-repeat right center;
				}
			}
		}

		&.disabled {
			a {
				pointer-events: none;
				cursor: default;
				opacity: 0.35;

				&:hover,
				&:focus,
				&:active {
					color: $dark;

					@include media-breakpoint-up( $bp-menu ) {
						color: $white;
					}
				}
			}
		}
	}

	> li {
		@include media-breakpoint-up( $bp-menu ) {
			> a.menu__link {
				padding: 5px 0 4px;
			}
			&:hover,
			&:focus,
			&:active {
				> a.menu__link {
					border-bottom: 1px solid $accent;
					color: $accent;
				}
				> a.menu__submenu-toggler {
					background: url( ../images/components/chevron-down-accent.svg ) no-repeat right center;
				}
			}
		}
	}

	&__submenu {
		display: block;
		position: static;
		width: 100%;
		height: auto;
		padding: rem( 1.3 ) 0 0 rem( 2 );
		transition: all 0.3s;

		@include media-breakpoint-up( $bp-menu ) {

			position: absolute;
			top: 100%;
			left: calc( 50% - #{rem( 2.6 )} );
			overflow: hidden;
			width: auto;
			flex: 1 0 rem( 25 );
			min-width: rem( 25 );
			max-height: 0;
			margin: rem( 1.2 ) 0 0;
			padding: 0;
			background: $accent-dark;
			border-radius: 0 0 rem( 1.2 ) rem( 1.2 );
			transform: translateX( -50% );
		}
		li {
			align-items: center;
			position: static;
			padding: rem( 1 ) 0;
			@include media-breakpoint-up( $bp-menu ) {
				padding: rem( 1 ) rem( 2 );

				&:first-child {
					padding-top: rem( 2 );
				}
				&:last-child {
					padding-bottom: rem( 2 );
				}
			}

			&.disabled {
				@include media-breakpoint-up( $bp-menu ) {
					position: relative;
					padding-right: rem( 3.2 );

					&:after {
						content: '';
						display: block;
						position: absolute;
						top: 50%;
						right: rem( 2 );
						width: 16px;
						height: 16px;
						margin: -8px 0 0;
						background: url( ../images/components/lock.svg ) no-repeat center;
						opacity: 0.35;
					}
				}
			}

			&.warning {
				@include media-breakpoint-up( $bp-menu ) {
					position: relative;
					padding-right: rem( 3.2 );

					&:after {
						content: '';
						display: block;
						position: absolute;
						top: 50%;
						right: rem( 2 );
						width: 16px;
						height: 16px;
						margin: -8px 0 0;
						background: url( ../images/components/warning.svg ) no-repeat center;
						opacity: 0.35;
					}
				}
			}

			&.beta {
				@include media-breakpoint-up( $bp-menu ) {
					position: relative;
					padding-right: rem( 3.2 );

					&:after {
						content: '';
						display: block;
						position: absolute;
						top: 50%;
						right: rem( 2 );
						width: 16px;
						height: 16px;
						margin: -8px 0 0;
						background: url( ../images/components/beta.svg) no-repeat center;
						opacity: 0.35;
					}
				}
			}

			a {
				font-size: rem( 1.4 );
				color: $dark;
				@include media-breakpoint-up( $bp-menu ) {
					display: block;
					padding: 0;
					border: none;
					color: $white;

					&:hover,
					&:focus,
					&:active {
						border: none;
						color: $accent;
					}
				}
			}
		}
	}

	> li:hover,
	.open {
		.menu__submenu {
			overflow: visible;
			@include media-breakpoint-up( $bp-menu ) {
				max-height: rem( 70 );
			}
		}
		.menu__submenu-toggler {
			@include media-breakpoint-up( $bp-menu ) {
				// transform: rotateX( 180deg );
			}
		}
	}
	> .header__account:hover,
	.open {
		.menu__submenu {
			@include media-breakpoint-up( $bp-menu ) {
				max-height: rem( 70 );
			}
		}
		.menu__submenu-toggler {
			@include media-breakpoint-up( $bp-menu ) {
				// transform: rotateX( 180deg );
			}
		}
	}
}
